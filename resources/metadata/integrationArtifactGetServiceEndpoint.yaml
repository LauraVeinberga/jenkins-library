metadata:
  name: integrationArtifactGetServiceEndpoint
  description: Get a deployed CPI intgeration flow service endpoint.
  longDescription: |
    With this step, you can obtain information about the service endpoints exposed by SAP Cloud Integration on a tenant using OData API. For more information on the SAP Cloud Integration remote API for deploying an integration artifact, see [Integration Content](https://help.sap.com/viewer/368c481cd6954bdfa5d0435479fd4eaf/Cloud/en-US/26797fbe259349b387a74a5a8f9785c1.html) on the SAP Help Portal.
spec:
  inputs:
    secrets:
      - name: cpiCredentialsId
        description: Jenkins credentials ID containing username and password for authentication to the SAP Cloud Platform Integration APIs.
        type: jenkins
    params:
      - name: username
        type: string
        description: User to authenticate to the SAP Cloud Integration service.
        scope:
          - PARAMETERS
          - STAGES
@@ -26,7 +26,7 @@ spec:
            param: username
      - name: password
        type: string
        description: Password to authenticate to the SAP Cloud Integration service.
        scope:
          - PARAMETERS
          - STAGES
@@ -39,31 +39,31 @@ spec:
            param: password
      - name: integrationFlowId
        type: string
        description: Specifies the ID of the integration flow artifact.
        scope:
          - PARAMETERS
          - STAGES
          - STEPS
        mandatory: true
      - name: platform
        type: string
        description: Specifies the running platform of the SAP Cloud Integration service.
        scope:
          - PARAMETERS
          - STAGES
          - STEPS
        mandatory: false
      - name: host
        type: string
        description: Specifies the protocol and host address, including the port. Please provide it in the format `<protocol>://<host>:<port>`. Supported protocols are `http` and `https`.
        scope:
          - PARAMETERS
          - STAGES
          - STEPS
        mandatory: true
      - name: oAuthTokenProviderUrl
        type: string
        description: Specifies the OAuth provider protocol and host address, including the port. Please provide it in the format `<protocol>://<host>:<port>`. Supported protocols are `http` and `https`.
        scope:
          - PARAMETERS
          - STAGES


spec:
  inputs:
    secrets:
      - name: cpiApiServiceKeyCredentialsId
        description: Jenkins secret text credential ID containing the service key to the Process Integration Runtime service instance of plan 'api'.
        type: jenkins
    params:
      - name: apiServiceKey
        type: string
        description: Service key JSON string to access the Process Integration Runtime service instance of plan 'api'.
        scope:
          - PARAMETERS
        mandatory: true
        secret: true
        resourceRef:
          - name: cpiApiServiceKeyCredentialsId
            type: secret
            param: apiServiceKey
      - name: integrationFlowId
        type: string
        description: Specifies the ID of the integration flow artifact.
        scope:
          - PARAMETERS
          - GENERAL
          - STAGES
          - STEPS
        mandatory: true
  outputs:
    resources:
      - name: commonPipelineEnvironment
        type: piperEnvironment
        params:
          - name: custom/integrationFlowServiceEndpoint
